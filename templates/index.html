{% extends "base.html" %}
{% block content %}

<div style="max-width:1300px; margin:40px auto;">

  <!-- ðŸ” Search Section -->
  <h2 style="text-align:center; margin-bottom:20px; color:#1f2937;">
    Find Your Perfect Job
  </h2>

  <form method="GET" action="{{ url_for('index') }}" class="search-bar">
    <input type="text" name="title" placeholder="Job title..." value="{{ request.args.get('title', '') }}">
    <input type="text" name="location" placeholder="Location..." value="{{ request.args.get('location', '') }}">
    <button type="submit">Search</button>
  </form>

  <!-- ðŸ”· Category Section (Horizontal scroll) -->
  <h3 style="margin:15px 0 10px; color:#1f2937;">Browse by Category</h3>

  <div class="category-scroll">
    {% for cat in categories %}
      <a href="{{ url_for('category_jobs', slug=slugify(cat)) }}" class="category-pill">
        {{ cat }}
      </a>
    {% endfor %}
  </div>

  <!-- ðŸ§± Job Grid Section -->
  <h3 style="margin:30px 0 10px; color:#1f2937;">Latest Jobs</h3>

  <div class="job-grid">
    {% if jobs.items %}
      {% for job in jobs.items %}
        <div class="job-card">
          <h3>{{ job.title }}</h3>

          <p><strong>Category:</strong> {{ job.category }}</p>
          <p><strong>Location:</strong> {{ job.location }}</p>
          <p><strong>Salary:</strong> {{ job.salary }}</p>

          <!-- âœ… Optional safety fix added -->
          <p>
            {{ job.description[:120] if job.description else "" }}
            {% if job.description and job.description|length > 120 %}...{% endif %}
          </p>

          <a href="{{ url_for('job_details', job_id=job.id) }}" class="btn">
            View Details
          </a>
        </div>
      {% endfor %}
    {% else %}
      <p style="text-align:center;">No jobs available yet.</p>
    {% endif %}
  </div>

</div>

<!-- ðŸ”¥ CSS Styling -->
<style>
  /* Search Bar */
  .search-bar {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 25px;
  }
  .search-bar input {
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
    width: 220px;
  }
  .search-bar button {
    padding: 10px 20px;
    background: #2563eb;
    color: white;
    border-radius: 6px;
    border: none;
  }

  /* Horizontal category scroll */
  .category-scroll {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding-bottom: 10px;
    white-space: nowrap;
  }

  .category-pill {
    background: #dbeafe;
    padding: 8px 16px;
    border-radius: 20px;
    color: #1e40af;
    text-decoration: none;
    font-size: 14px;
    border: 1px solid #93c5fd;
    transition: 0.2s ease-in-out;
  }

  .category-pill:hover {
    background: #2563eb;
    color: white;
    border-color: #2563eb;
  }

  /* Jobs Grid */
  .job-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 25px;
  }

  .job-card {
    background: white;
    padding: 18px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    transition: 0.3s;
  }

  .job-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
  }

  .job-card h3 {
    margin-bottom: 8px;
    color: #1f2937;
  }

  .btn {
    background: #2563eb;
    color: white;
    padding: 8px 14px;
    border-radius: 6px;
    text-decoration: none;
    margin-top: 8px;
    display: inline-block;
  }
</style>

{% endblock %}